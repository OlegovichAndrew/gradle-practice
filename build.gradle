/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.4.2/samples
 */

def clean(){
   exec {
        executable "sh"
        args "-c", "ls"
    }
}

def dockerBuild() {
    exec {
        commandLine 'sh', '-c', 'docker build -t gradledockertest:latest ./clonedRepo/AWS-Task2/AWS_Download_S3'
    }
}

def dockerRun() {
    exec {
        commandLine 'sh', '-c', 'docker run --name gradledocker gradledockertest:latest'
    }
}

task buildWith {

    exec {
        workingDir '.'
        commandLine 'sh', '-c', 'mkdir clonedRepo'
    }

    exec {
        workingDir './clonedRepo'
        commandLine 'sh', '-c', 'git clone https://github.com/OlegovichAndrew/AWS-Task2.git'
    }

    dockerBuild()
    dockerRun()
    doLast {
        clean()
    }
}